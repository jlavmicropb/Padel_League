<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Let's Go Padel League Series</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 50%, #1a1a1a 100%);
            min-height: 100vh;
            color: #ffffff;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        /* Header / Logo */
        .header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .logo {
            display: inline-block;
            margin-bottom: 1rem;
        }

        .logo-text {
            font-size: 2.5rem;
            font-weight: 900;
            font-style: italic;
            color: #a3e635;
            text-transform: uppercase;
            line-height: 1.1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .logo-ball {
            display: inline-block;
            width: 12px;
            height: 12px;
            background: #a3e635;
            border-radius: 50%;
            margin-left: 5px;
            vertical-align: super;
        }

        .main-title {
            font-size: 1.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: #cccccc;
        }

        /* Location selector */
        .location-selector {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .location-btn {
            padding: 0.75rem 2rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            color: #ffffff;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            letter-spacing: 1px;
        }

        .location-btn:hover {
            border-color: #a3e635;
            color: #a3e635;
        }

        .location-btn.active {
            background: #a3e635;
            border-color: #a3e635;
            color: #1a1a1a;
        }

        .location-content {
            display: none;
        }

        .location-content.active {
            display: block;
        }

        /* League selector */
        .league-selector {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .league-btn {
            padding: 0.5rem 1.25rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #cccccc;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }

        .league-btn:hover {
            border-color: #a3e635;
            color: #a3e635;
        }

        .league-btn.active {
            background: rgba(163, 230, 53, 0.15);
            border-color: #a3e635;
            color: #a3e635;
        }

        .league-content {
            display: none;
        }

        .league-content.active {
            display: block;
        }

        /* Coming soon section */
        .coming-soon {
            text-align: center;
            padding: 4rem 2rem;
        }

        .coming-soon-title {
            font-size: 1.8rem;
            font-weight: 700;
            text-transform: uppercase;
            color: #a3e635;
            margin-bottom: 1rem;
            letter-spacing: 2px;
        }

        .coming-soon-text {
            font-size: 1.1rem;
            color: #999;
            margin-bottom: 2rem;
        }

        .coming-soon-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            opacity: 0.5;
        }

        /* Section styling */
        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            text-transform: uppercase;
            text-decoration: underline;
            text-decoration-color: #a3e635;
            text-underline-offset: 8px;
            text-align: center;
            margin-bottom: 1.5rem;
            letter-spacing: 2px;
        }

        /* Teams list */
        .teams-list {
            list-style: none;
            text-align: center;
        }

        .teams-list li {
            font-size: 1.1rem;
            font-weight: 600;
            text-transform: uppercase;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .teams-list li:last-child {
            border-bottom: none;
        }

        /* Schedule */
        .schedule-item {
            text-align: center;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .schedule-item:last-child {
            border-bottom: none;
        }

        .week-title {
            font-size: 1.1rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .week-dates {
            color: #cccccc;
        }

        .deadline {
            color: #a3e635;
            font-weight: 600;
            font-style: italic;
        }

        .finals-note {
            font-size: 0.9rem;
            color: #999;
            font-style: italic;
            margin-top: 0.5rem;
        }

        /* Fixtures */
        .fixture {
            text-align: center;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fixture:last-child {
            border-bottom: none;
        }

        .fixture-teams {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.95rem;
        }

        .fixture-vs {
            color: #a3e635;
            font-weight: 700;
            margin: 0 0.5rem;
        }

        .fixture-note {
            text-align: center;
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(163, 230, 53, 0.1);
            border-radius: 8px;
            font-style: italic;
            color: #a3e635;
        }

        .fixture-time {
            text-align: center;
            font-size: 0.75rem;
            color: #a3e635;
            margin-top: 0.25rem;
        }

        .result-time {
            text-align: center;
            font-size: 0.75rem;
            color: #999;
            margin-top: 0.5rem;
        }

        /* Navigation tabs */
        .nav {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: #ffffff;
            font-weight: 600;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .nav-btn:hover {
            background: rgba(163, 230, 53, 0.2);
        }

        .nav-btn.active {
            background: #a3e635;
            color: #1a1a1a;
        }

        /* Tab content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Group selector */
        .group-selector {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .group-btn {
            padding: 0.5rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: #cccccc;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .group-btn:hover {
            border-color: #a3e635;
            color: #a3e635;
        }

        .group-btn.active {
            background: #a3e635;
            border-color: #a3e635;
            color: #1a1a1a;
        }

        .group-content {
            display: none;
        }

        .group-content.active {
            display: block;
        }

        /* Week selector for fixtures */
        .week-selector {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .week-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #cccccc;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }

        .week-btn:hover {
            border-color: #a3e635;
            color: #a3e635;
        }

        .week-btn.active {
            background: #a3e635;
            border-color: #a3e635;
            color: #1a1a1a;
        }

        .fixtures-week, .results-week {
            display: none;
        }

        .fixtures-week.active, .results-week.active {
            display: block;
        }

        /* Results styling */
        .result-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .result-match {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .result-team {
            flex: 1;
            min-width: 120px;
            text-align: center;
        }

        .result-team-name {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .result-team.winner .result-team-name {
            color: #a3e635;
        }

        .result-score {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .score-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 1.5rem;
            font-weight: 700;
            min-width: 50px;
            text-align: center;
        }

        .score-box.winner {
            background: #a3e635;
            color: #1a1a1a;
        }

        .score-divider {
            font-size: 1.2rem;
            color: #666;
        }

        /* Leaderboard styling */
        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .leaderboard-table th,
        .leaderboard-table td {
            padding: 0.75rem 0.5rem;
            text-align: center;
        }

        .leaderboard-table th {
            background: rgba(163, 230, 53, 0.2);
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 1px;
        }

        .leaderboard-table tbody tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .leaderboard-table tbody tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .leaderboard-table .position {
            font-weight: 700;
            color: #a3e635;
        }

        .leaderboard-table .team-name {
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8rem;
        }

        .leaderboard-table .points {
            font-weight: 700;
            color: #a3e635;
            font-size: 1.1rem;
        }

        .leaderboard-top-3 {
            background: rgba(163, 230, 53, 0.05);
        }

        .position-badge {
            display: inline-block;
            width: 24px;
            height: 24px;
            line-height: 24px;
            border-radius: 50%;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .position-1 { background: #ffd700; color: #1a1a1a; }
        .position-2 { background: #c0c0c0; color: #1a1a1a; }
        .position-3 { background: #cd7f32; color: #1a1a1a; }

        .scoring-info {
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            font-size: 0.85rem;
            color: #999;
        }

        .scoring-info strong {
            color: #a3e635;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .logo-text {
                font-size: 2rem;
            }

            .main-title {
                font-size: 1.4rem;
            }

            .section {
                padding: 1.5rem 1rem;
            }

            .fixture-teams {
                font-size: 0.85rem;
            }

            .nav-btn {
                padding: 0.6rem 1rem;
                font-size: 0.8rem;
            }

            .result-team-name {
                font-size: 0.75rem;
            }

            .score-box {
                font-size: 1.2rem;
                padding: 0.4rem 0.8rem;
                min-width: 40px;
            }

            .leaderboard-table {
                font-size: 0.75rem;
            }

            .leaderboard-table th,
            .leaderboard-table td {
                padding: 0.5rem 0.25rem;
            }

            .leaderboard-table .team-name {
                font-size: 0.7rem;
            }

            .location-btn {
                padding: 0.6rem 1.5rem;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-text">LET'S<br>GO PADEL<span class="logo-ball"></span></div>
            </div>
            <h1 class="main-title">Let's Go Padel League Series</h1>
            <p class="subtitle" id="location-subtitle">Carryduff</p>
        </header>

        <!-- Location Selector -->
        <div class="location-selector">
            <button class="location-btn active" onclick="showLocation('carryduff')">Carryduff</button>
            <button class="location-btn" onclick="showLocation('ballyclare')">Ballyclare</button>
        </div>

        <!-- CARRYDUFF LOCATION -->
        <div id="location-carryduff" class="location-content active">
            <!-- League Selector -->
            <div class="league-selector">
                <button class="league-btn active" onclick="showLeague('carryduff', 'winter-2026')">Winter 2026</button>
                <button class="league-btn" onclick="showLeague('carryduff', 'summer-2026')">Summer 2026</button>
            </div>

            <!-- Winter League 2026 -->
            <div id="carryduff-winter-2026" class="league-content active">
                <!-- Navigation -->
                <nav class="nav">
                    <button class="nav-btn" onclick="showTab('carryduff', 'teams')">Teams</button>
                    <button class="nav-btn" onclick="showTab('carryduff', 'schedule')">Schedule</button>
                    <button class="nav-btn" onclick="showTab('carryduff', 'fixtures')">Fixtures</button>
                    <button class="nav-btn" onclick="showTab('carryduff', 'results')">Results</button>
                    <button class="nav-btn active" onclick="showTab('carryduff', 'leaderboard')">Leaderboard</button>
                </nav>

                <!-- Teams Tab -->
                <div id="carryduff-teams" class="tab-content">
                    <div class="group-selector">
                        <button class="group-btn active" onclick="showGroup('carryduff-teams', 'A')">Group A</button>
                        <button class="group-btn" onclick="showGroup('carryduff-teams', 'B')">Group B</button>
                        <button class="group-btn" onclick="showGroup('carryduff-teams', 'C')">Group C</button>
                    </div>
                    <div id="carryduff-teams-A" class="group-content active"></div>
                    <div id="carryduff-teams-B" class="group-content"></div>
                    <div id="carryduff-teams-C" class="group-content"></div>
                </div>

                <!-- Schedule Tab -->
                <div id="carryduff-schedule" class="tab-content"></div>

                <!-- Fixtures Tab -->
                <div id="carryduff-fixtures" class="tab-content">
                    <div class="group-selector">
                        <button class="group-btn active" onclick="showGroup('carryduff-fixtures', 'A')">Group A</button>
                        <button class="group-btn" onclick="showGroup('carryduff-fixtures', 'B')">Group B</button>
                        <button class="group-btn" onclick="showGroup('carryduff-fixtures', 'C')">Group C</button>
                    </div>
                    <div id="carryduff-fixtures-A" class="group-content active"></div>
                    <div id="carryduff-fixtures-B" class="group-content"></div>
                    <div id="carryduff-fixtures-C" class="group-content"></div>
                </div>

                <!-- Results Tab -->
                <div id="carryduff-results" class="tab-content">
                    <div class="group-selector">
                        <button class="group-btn active" onclick="showGroup('carryduff-results', 'A')">Group A</button>
                        <button class="group-btn" onclick="showGroup('carryduff-results', 'B')">Group B</button>
                        <button class="group-btn" onclick="showGroup('carryduff-results', 'C')">Group C</button>
                    </div>
                    <div id="carryduff-results-A" class="group-content active"></div>
                    <div id="carryduff-results-B" class="group-content"></div>
                    <div id="carryduff-results-C" class="group-content"></div>
                </div>

                <!-- Leaderboard Tab -->
                <div id="carryduff-leaderboard" class="tab-content active">
                    <div class="group-selector">
                        <button class="group-btn active" onclick="showGroup('carryduff-leaderboard', 'A')">Group A</button>
                        <button class="group-btn" onclick="showGroup('carryduff-leaderboard', 'B')">Group B</button>
                        <button class="group-btn" onclick="showGroup('carryduff-leaderboard', 'C')">Group C</button>
                    </div>
                    <div id="carryduff-leaderboard-A" class="group-content active"></div>
                    <div id="carryduff-leaderboard-B" class="group-content"></div>
                    <div id="carryduff-leaderboard-C" class="group-content"></div>
                </div>
            </div>

            <!-- Summer League 2026 -->
            <div id="carryduff-summer-2026" class="league-content">
                <section class="section">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">&#9728;</div>
                        <h2 class="coming-soon-title">Summer League 2026</h2>
                        <p class="coming-soon-text">Registration opens soon!</p>
                        <p class="coming-soon-text">Stay tuned for fixtures, teams, and more.</p>
                    </div>
                </section>
            </div>
        </div>

        <!-- BALLYCLARE LOCATION -->
        <div id="location-ballyclare" class="location-content">
            <!-- League Selector -->
            <div class="league-selector">
                <button class="league-btn active" onclick="showLeague('ballyclare', 'winter-2026')">Winter 2026</button>
                <button class="league-btn" onclick="showLeague('ballyclare', 'summer-2026')">Summer 2026</button>
            </div>

            <!-- Winter League 2026 -->
            <div id="ballyclare-winter-2026" class="league-content active">
                <section class="section">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">&#127934;</div>
                        <h2 class="coming-soon-title">Ballyclare Winter League</h2>
                        <p class="coming-soon-text">Details coming soon!</p>
                        <p class="coming-soon-text">Stay tuned for fixtures, teams, and more.</p>
                    </div>
                </section>
            </div>

            <!-- Summer League 2026 -->
            <div id="ballyclare-summer-2026" class="league-content">
                <section class="section">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">&#9728;</div>
                        <h2 class="coming-soon-title">Summer League 2026</h2>
                        <p class="coming-soon-text">Registration opens soon!</p>
                        <p class="coming-soon-text">Stay tuned for fixtures, teams, and more.</p>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Data service: config + abstraction layer -->
    <script src="js/config.js"></script>
    <script src="js/db.js"></script>

    <script>
    // =========================================================================
    // DATA - loaded via DB abstraction layer (see js/config.js to switch provider)
    // =========================================================================

    let DATA = null;

    // =========================================================================
    // RENDERING ENGINE
    // =========================================================================

    function comingSoonHTML(title) {
        return `<section class="section">
            <div class="coming-soon">
                <div class="coming-soon-icon">&#127934;</div>
                <h2 class="coming-soon-title">${title}</h2>
                <p class="coming-soon-text">Details coming soon!</p>
                <p class="coming-soon-text">Stay tuned for fixtures, teams, and more.</p>
            </div>
        </section>`;
    }

    function renderTeams(teams, groupLabel) {
        return `<section class="section">
            <h2 class="section-title">Group ${groupLabel}</h2>
            <ul class="teams-list">
                ${teams.map(t => `<li>${t}</li>`).join('')}
            </ul>
        </section>`;
    }

    function renderSchedule(schedule) {
        let html = '<section class="section"><h2 class="section-title">League Schedule</h2>';
        for (const s of schedule) {
            html += `<div class="schedule-item">
                <div class="week-title">Week ${s.week}: <span class="week-dates">${s.dates}</span></div>
                <div class="deadline">(Deadline for matches ${s.deadline})</div>
                ${s.finals ? '<div class="finals-note">As this is finals week, further details will be announced in due course</div>' : ''}
            </div>`;
        }
        html += '</section>';
        return html;
    }

    function renderFixtures(location, group, fixtures, schedule) {
        let html = `<section class="section"><h2 class="section-title">Group ${group} Fixtures</h2>`;
        // Week selector
        html += '<div class="week-selector">';
        for (let w = 1; w <= 6; w++) {
            html += `<button class="week-btn${w === 1 ? ' active' : ''}" onclick="showWeek('${location}', '${group}', ${w})">Week ${w}</button>`;
        }
        html += '</div>';

        for (let w = 1; w <= 6; w++) {
            html += `<div id="${location}-week-${group}-${w}" class="fixtures-week${w === 1 ? ' active' : ''}">`;
            if (w === 6) {
                html += '<div class="fixture"><div class="fixture-teams">Finals Week</div></div>';
                html += '<div class="fixture-note">Further details will be announced in due course</div>';
            } else if (fixtures && fixtures[w]) {
                for (const f of fixtures[w]) {
                    html += `<div class="fixture">
                        <div class="fixture-teams">${f.team1} <span class="fixture-vs">vs</span> ${f.team2}</div>
                        ${f.time ? `<div class="fixture-time">${f.time}</div>` : ''}
                    </div>`;
                }
                const sched = schedule.find(s => s.week === w);
                if (sched) {
                    html += `<div class="fixture-note">Matches to be played on or before ${sched.deadline}</div>`;
                }
            } else {
                html += '<div class="fixture-note">Fixtures to be confirmed</div>';
            }
            html += '</div>';
        }
        html += '</section>';
        return html;
    }

    function renderResults(location, group, results, schedule) {
        let html = `<section class="section"><h2 class="section-title">Group ${group} Results</h2>`;
        // Week selector
        html += '<div class="week-selector">';
        for (let w = 1; w <= 6; w++) {
            html += `<button class="week-btn${w === 1 ? ' active' : ''}" onclick="showResultsWeek('${location}', '${group}', ${w})">Week ${w}</button>`;
        }
        html += '</div>';

        for (let w = 1; w <= 6; w++) {
            html += `<div id="${location}-results-week-${group}-${w}" class="results-week${w === 1 ? ' active' : ''}">`;
            if (w === 6) {
                html += '<div class="fixture-note">Finals week - Details to be announced</div>';
            } else if (results && results[w] && results[w].length > 0) {
                for (const r of results[w]) {
                    const t1Wins = r.score1 > r.score2;
                    html += `<div class="result-card">
                        <div class="result-match">
                            <div class="result-team${t1Wins ? ' winner' : ''}">
                                <div class="result-team-name">${r.team1}</div>
                            </div>
                            <div class="result-score">
                                <div class="score-box${t1Wins ? ' winner' : ''}">${r.score1}</div>
                                <div class="score-divider">-</div>
                                <div class="score-box${!t1Wins ? ' winner' : ''}">${r.score2}</div>
                            </div>
                            <div class="result-team${!t1Wins ? ' winner' : ''}">
                                <div class="result-team-name">${r.team2}</div>
                            </div>
                        </div>
                        <div class="result-time">Sets: ${r.sets} | ${r.date}</div>
                    </div>`;
                }
                // Check how many fixtures this week has vs results
                const fixtureCount = 3; // Each week has 3 fixtures
                const resultCount = results[w].length;
                if (resultCount < fixtureCount) {
                    const sched = schedule.find(s => s.week === w);
                    html += `<div class="fixture-note">${fixtureCount - resultCount} result${fixtureCount - resultCount > 1 ? 's' : ''} pending${sched ? ' - Deadline ' + sched.deadline : ''}</div>`;
                }
            } else {
                const sched = schedule.find(s => s.week === w);
                html += `<div class="fixture-note">Results pending${sched ? ' - Deadline ' + sched.deadline : ''}</div>`;
            }
            html += '</div>';
        }
        html += '</section>';
        return html;
    }

    // =========================================================================
    // LEADERBOARD AUTO-CALCULATION
    // =========================================================================

    function calculateLeaderboard(teams, results) {
        // Initialize standings
        const standings = {};
        for (const team of teams) {
            standings[team] = { name: team, p: 0, w: 0, l: 0, sf: 0, sa: 0, pts: 0 };
        }

        // Process all results
        if (results) {
            for (const week in results) {
                for (const r of results[week]) {
                    const t1 = standings[r.team1];
                    const t2 = standings[r.team2];
                    if (!t1 || !t2) continue;

                    t1.p++;
                    t2.p++;
                    t1.sf += r.score1;
                    t1.sa += r.score2;
                    t2.sf += r.score2;
                    t2.sa += r.score1;

                    if (r.score1 > r.score2) {
                        t1.w++;
                        t2.l++;
                        t1.pts += (r.score1 === 3 && r.score2 === 0) ? 3 : 2;
                        t2.pts += 1;
                    } else {
                        t2.w++;
                        t1.l++;
                        t2.pts += (r.score2 === 3 && r.score1 === 0) ? 3 : 2;
                        t1.pts += 1;
                    }
                }
            }
        }

        // Sort: points desc, then SD desc, then SF desc
        const sorted = Object.values(standings).sort((a, b) => {
            const sdA = a.sf - a.sa, sdB = b.sf - b.sa;
            if (b.pts !== a.pts) return b.pts - a.pts;
            if (sdB !== sdA) return sdB - sdA;
            return b.sf - a.sf;
        });

        return sorted;
    }

    function renderLeaderboard(teams, results, groupLabel) {
        const standings = calculateLeaderboard(teams, results);

        let html = `<section class="section"><h2 class="section-title">Group ${groupLabel} Standings</h2>`;
        html += `<table class="leaderboard-table">
            <thead><tr>
                <th>Pos</th><th class="team-name">Team</th><th>P</th><th>W</th><th>L</th><th>SF</th><th>SA</th><th>SD</th><th>Pts</th>
            </tr></thead><tbody>`;

        let pos = 1;
        for (const s of standings) {
            const sd = s.sf - s.sa;
            const sdStr = sd > 0 ? '+' + sd : String(sd);
            const isTop3 = pos <= 3 && s.p > 0;
            const hasPlayed = s.p > 0;

            if (isTop3) {
                html += `<tr class="leaderboard-top-3">
                    <td><span class="position-badge position-${pos}">${pos}</span></td>`;
            } else {
                html += `<tr><td class="position">${hasPlayed ? pos : '-'}</td>`;
            }

            html += `<td class="team-name">${s.name}</td>
                <td>${s.p}</td><td>${s.w}</td><td>${s.l}</td>
                <td>${s.sf}</td><td>${s.sa}</td><td>${sdStr}</td>
                <td class="points">${s.pts}</td></tr>`;

            if (hasPlayed) pos++;
        }

        html += `</tbody></table>
            <div class="scoring-info">
                <strong>Scoring System:</strong> Win 3-0 = 3 pts | Win 2-1 = 2 pts | Loss = 1 pt<br>
                <strong>Tiebreakers:</strong> Set Difference (SD) then Sets For (SF)
            </div>
        </section>`;
        return html;
    }

    // =========================================================================
    // RENDER THE PAGE FROM DATA
    // =========================================================================

    async function renderAll() {
        // Load data from configured provider (local JSON, Firebase, or Supabase)
        DATA = await DB.getAllData();

        const carryduffWinter = DATA.carryduff["winter-2026"];

        // Schedule (shared across groups)
        document.getElementById('carryduff-schedule').innerHTML = renderSchedule(carryduffWinter.schedule);

        // Render each group
        const groups = ['A', 'B', 'C'];
        for (const g of groups) {
            const groupData = carryduffWinter.groups[g];

            if (!groupData) {
                // No data for this group - show coming soon
                document.getElementById('carryduff-teams-' + g).innerHTML = comingSoonHTML('Group ' + g);
                document.getElementById('carryduff-fixtures-' + g).innerHTML = comingSoonHTML('Group ' + g + ' Fixtures');
                document.getElementById('carryduff-results-' + g).innerHTML = comingSoonHTML('Group ' + g + ' Results');
                document.getElementById('carryduff-leaderboard-' + g).innerHTML = comingSoonHTML('Group ' + g + ' Standings');
            } else {
                document.getElementById('carryduff-teams-' + g).innerHTML = renderTeams(groupData.teams, g);
                document.getElementById('carryduff-fixtures-' + g).innerHTML = renderFixtures('carryduff', g, groupData.fixtures, carryduffWinter.schedule);
                document.getElementById('carryduff-results-' + g).innerHTML = renderResults('carryduff', g, groupData.results, carryduffWinter.schedule);
                document.getElementById('carryduff-leaderboard-' + g).innerHTML = renderLeaderboard(groupData.teams, groupData.results, g);
            }
        }
    }

    // =========================================================================
    // NAVIGATION
    // =========================================================================

    let currentLocation = 'carryduff';

    function showLocation(location) {
        currentLocation = location;

        document.querySelectorAll('.location-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');

        document.getElementById('location-subtitle').textContent =
            location.charAt(0).toUpperCase() + location.slice(1);

        document.querySelectorAll('.location-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById('location-' + location).classList.add('active');
    }

    function showLeague(location, league) {
        const container = document.getElementById('location-' + location);

        container.querySelectorAll('.league-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');

        container.querySelectorAll('.league-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById(location + '-' + league).classList.add('active');
    }

    function showTab(location, tabId) {
        const container = document.getElementById('location-' + location);
        container.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        container.querySelectorAll('.nav-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(location + '-' + tabId).classList.add('active');
        event.target.classList.add('active');
    }

    function showGroup(containerId, group) {
        const container = document.getElementById(containerId);
        container.querySelectorAll('.group-content').forEach(content => {
            content.classList.remove('active');
        });
        container.querySelectorAll('.group-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(containerId + '-' + group).classList.add('active');
        event.target.classList.add('active');
    }

    function showWeek(location, group, weekNum) {
        const container = document.getElementById(location + '-fixtures-' + group);
        container.querySelectorAll('.fixtures-week').forEach(week => {
            week.classList.remove('active');
        });
        container.querySelectorAll('.week-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(location + '-week-' + group + '-' + weekNum).classList.add('active');
        event.target.classList.add('active');
    }

    function showResultsWeek(location, group, weekNum) {
        const container = document.getElementById(location + '-results-' + group);
        container.querySelectorAll('.results-week').forEach(week => {
            week.classList.remove('active');
        });
        container.querySelectorAll('.week-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(location + '-results-week-' + group + '-' + weekNum).classList.add('active');
        event.target.classList.add('active');
    }

    // Initialize
    renderAll().catch(err => console.error('Failed to load league data:', err));
    </script>
</body>
</html>
